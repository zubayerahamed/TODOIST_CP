<h3 class="fw-bold border-bottom p-2 text-center mb-0">Workspace settings</h3>
<div class="d-flex">
  <div class="col-md-3">
    <div class="mb-3">
      <label for="workspaceName" class="form-label fw-bold text-muted">Workspace name</label>
      <input type="text" class="form-control" id="workspaceName" [(ngModel)]="enteredWorkspaceName">
    </div>
    <button type="button" class="btn btn-primary" (click)="onUpdateWorkspace()">Save</button>
  </div>
</div>
<div class="divider"></div>
<div class="d-flex flex-column gap-3">
  <h5>Types & Colors</h5>
  <div class="mb-2">
    <label for="workspaceName" class="form-label fw-bold text-muted">Task types</label>
    <div class="d-flex gap-2 flex-wrap">
      @for(category of taskCategories; track category.id) {
        <div class="d-flex gap-2 align-items-center border rounded p-2">
          <div class="rounded" [style.background-color]="category.color" style="height: 20px; width: 20px;"></div>
          <div>{{ category.name }}</div>
        </div>
        }
    </div>
  </div>
  <div class="mb-2">
    <label for="workspaceName" class="form-label fw-bold text-muted">Event types</label>
    <div class="d-flex gap-2 flex-wrap">
      @for(category of eventCategories; track category.id) {
        <div class="d-flex gap-2 align-items-center border rounded p-2">
          <div class="rounded" [style.background-color]="category.color" style="height: 20px; width: 20px;"></div>
          <div>{{ category.name }}</div>
        </div>
        }
    </div>
  </div>
  <div class="mb-2">
    <button type="button" class="btn btn-primary" (click)="openEditTypesModal()">Edit types</button>
  </div>
  <div class="mb-2">
    <label class="form-label fw-bold text-muted">Default type of tasks</label>
    <div class="custom-dropdown" id="defaultTaskTypeDropdown">
      <div class="dropdown-selected" [class.active]="isTaskDropdownOpen" (click)="toggleTaskDropdown()">
        @if(defaultTaskCategory){
          <div class="selected-option">
            <div class="color-circle" [style.background-color]="defaultTaskCategory.color"></div>
            <span>{{ defaultTaskCategory.name }}</span>
          </div>
          } @else {
          <div class="selected-option">
            <span>-- Select default task type --</span>
          </div>
          }
          <span class="dropdown-arrow">▼</span>
      </div>
      <div class="dropdown-options" id="defaultTaskTypeOptions" [style.display]="isTaskDropdownOpen ? 'flex' : 'none'">
        @for(category of taskCategories; track category.id) {
          <div class="dropdown-option" (click)="onSelectDefaultTask(category)">
            <div class="color-circle" [style.background-color]="category.color"></div>
            <span>{{ category.name }}</span>
          </div>
          }
      </div>
    </div>
  </div>

  <div class="mb-2">
    <label class="form-label fw-bold text-muted">Default type of events</label>
    <div class="custom-dropdown" id="defaultEventTypeDropdown">
      <div class="dropdown-selected" [class.active]="isEventDropdownOpen" (click)="toggleEventDropdown()">
        @if(defaultEventCategory){
          <div class="selected-option">
            <div class="color-circle" [style.background-color]="defaultEventCategory.color"></div>
            <span>{{ defaultEventCategory.name }}</span>
          </div>
          } @else {
          <div class="selected-option">
            <span>-- Select default event type --</span>
          </div>
          }
          <span class="dropdown-arrow">▼</span>
      </div>
      <div class="dropdown-options" id="defaultEventTypeOptions" [style.display]="isEventDropdownOpen ? 'flex' : 'none'">
        @for(category of eventCategories; track category.id) {
          <div class="dropdown-option" (click)="onSelectDefaultEvent(category)">
            <div class="color-circle" [style.background-color]="category.color"></div>
            <span>{{ category.name }}</span>
          </div>
          }
      </div>
    </div>
  </div>

</div>

<div class="divider"></div>

<!-- Tags Section -->
<div class="d-flex flex-column gap-3">
  <h5>Tags</h5>
  <div class="tags-container align-items-center">
    @for(tag of tags; track tag.id) {
      <div class="tag-pill">
        <span>{{ tag.name }}</span>
        <i class="ph ph-trash text-danger ms-3" (click)="removeTag(tag.id, tag.name)"></i>
      </div>
      }
  </div>
  <div class="create-tag-section">
    <button type="button" class="btn-create-tag" (click)="openEditTagModal()">
      <i class="ph ph-plus fw-bold"></i>
      <span>Create tag</span>
    </button>
  </div>
</div>

<div class="divider"></div>

<!-- Task Statuses Section -->
<div class="d-flex flex-column gap-3">
  <h5>Task statuses</h5>
  <div class="status-flow-container">
    @for(workflow of nonSystemDefinedWorkflows; track workflow.id) {
      <div class="status-pill status-new-task" [style.background-color]="workflow.color">{{ workflow.name }}</div>
      <div class="status-arrow">
        <i class="ph ph-arrow-right fw-bold"></i>
      </div>
      }
      @if(systemDefinedWorkflow) {
        <div class="status-pill status-completed" [style.background-color]="systemDefinedWorkflow.color">{{ systemDefinedWorkflow.name }}</div>
        }
  </div>
  <div>
    <button type="button" class="btn btn-primary" (click)="openEditStatusesModal()">Edit statuses</button>
  </div>
</div>

<!-- Edit Types Modal -->
<app-types
           [projectId]="0"
           [isProjectType]="false"
           [isEditTypesModalOpen]="isEditTypesModalOpen"
           [categories]="categories"
           (onEditTypesModalClose)="onEditTypesModalClose()"
           (triggerRefreshAfterSave)="onTriggerRefreshAfterSave()" />

<!-- Edit Statuses Modal -->
<app-statuses
              [projectId]="0"
              [isProjectType]="false"
              [isEditStatusesModalOpen]="isEditStatusesModalOpen"
              [statuses]="workflows"
              (onEditStatusesModalClose)="onEditStatusesModalClose()"
              (triggerRefreshAfterSave)="onTriggerRefreshAfterSave()" />

<!-- Edit tag modal -->
<app-tags
          [isCreateTagModalOpen]="isCreateTagModalOpen"
          (closeTagModal)="onEditTagModalClose()"
          (triggerRefreshAfterSave)="onTriggerRefreshAfterSave()" />
